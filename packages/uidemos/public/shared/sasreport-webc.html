/* * va report viewer web component */
<template id="rafVaReportTemplate">
	<style>
		.grid {
			display: table;
			width: calc(100% + 1.75rem);
			border-collapse: separate;
			border-spacing: 1rem;
			margin: -1rem;
			height: inherit;
		}
		.gridRow {
			display: table-row;
		}
		.gridCell {
			display: table-cell;
			width: 50%;
			padding-bottom: 56.25%;
			position: relative;
		}
		.component {
			position: absolute;
			top: 0;
			bottom: 0;
			left: 0;
			right: 0;
			display: flex;
			flex-flow: column;
		}
		.componentIframe {
			border: 1px solid #000000;
			margin-top: 0.5rem;
			display: flex;
			align-items: flex-start;
			flex: 1;
		}
		.componentHeader {
			height: 20px;
			width: 100%;
			display: flex;
			align-items: flex-start;
		}
	</style>

	<div class="grid">
		<div class="gridRow">
			<div class="gridCell">
				<div id="component1" class="component">
					<div id="reportViewer" class="componentIframe"></div>
					<p id="err" style="display: none;"></p>
				</div>
			</div>
		</div>
	</div>
</template>

<script>
	function reportSetup(state) {
		let { url, name, reportUri, style, authorizationType } = state;
        if (this.state.attached === true) {
            nextElement.removeChild(this.state.objectElement);
            this.state.attached = false;
        }
        this.state.objectElement = this.makeElement();
        nextElement.appendChild(this.state.objectElement);
        this.state.attached = true;
		return true;
    }
    
	class sasReportwebc extends HTMLElement {
		constructor() {
			super();
		}

		static get observedAttributes() {
			return [];
		}

		createdCallback() {
			this.shadow = this.createShadowRoot();
			let localDoc = document.currentScript
				? document.currentScript.ownerDocument
				: rafVaReportLocalDoc;
			let template = localDoc.querySelector('#rafVaReportTemplate');
			let clone = document.importNode(template.content, true);
			this.shadow.appendChild(clone);
		}

		attachedCallback() {
			this.state = {};
			this.initState();
		}

		detachedCallback() {}

		attributeChangedCallback(attributeName, oldValue, newValue) {}

		set properties(props) {
			this.initState();
			this.state.url = props.url;
			this.state.reportUri = props.reportUri;
			this.state.style = props.style;
			this.state.authenticationType = props.authenticationType;

            reportSetup(this.state);

		}

		initState() {
			this.state.failed = `fill="#000000" height="48" viewBox="0 0 24 24" width="48" xmlns="http://www.w3.org/2000/svg">
                    <path d="M11.99 2C6.47 2 2 6.47 2 12s4.47 10 9.99 10S22 17.53 22 12 17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm4.18-12.24l-1.06 1.06-1.06-1.06L13 8.82l1.06 1.06L13 10.94 14.06 12l1.06-1.06L16.18 12l1.06-1.06-1.06-1.06 1.06-1.06zM7.82 12l1.06-1.06L9.94 12 11 10.94 9.94 9.88 11 8.82 9.94 7.76 8.88 8.82 7.82 7.76 6.76 8.82l1.06 1.06-1.06 1.06zM12 14c-2.33 0-4.31 1.46-5.11 3.5h10.22c-.8-2.04-2.78-3.5-5.11-3.5z"/>
                    <path d="M0 0h24v24H0z" fill="none"`;
			this.state.svg = `<svg fill="#000000" height="48" viewBox="0 0 24 24" width="48" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
</svg>`;
			this.state.attached = false;
		}

		makeElement() {
            debugger;
			let objectElement  = new vaReportComponents.SASReportElement();
			objectElement.authenticationType = this.state.authenticationType;
			objectElement.url                = this.state.url;
            objectElement.reportUri          = this.state.reportUri;
            objectElement.style              = this.state.style;
			return objectElement;
		}
	}

	let erafVaReport = document.registerElement('sasreport-webc', sasReportwebc);
	/*
	 * Need this until imports are fully supported in browsers
	 */
	let rafVaReportLocalDoc = document.currentScript.ownerDocument;
</script>
